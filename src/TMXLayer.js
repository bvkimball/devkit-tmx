import .TMXTile as TMXTile;

exports = Class(function() {

        this.init = function(opts) {
            this._columns = opts.width;
            this._rows = opts.height;
            this._tiles = new Array(this._rows);
            for (var r = 0; r < this._rows; r++) {
                this._tiles[r] = new Array(this._columns);
            }
            for (var t in opts.data) {
                var column = t % opts.width;
                var row = Math.floor(t / opts.width);
                var type = opts.data[t];
                console.log('Creating tile ', type, ' at ', column, row);
                this._tiles[row][column] = type;
            };
    };

    this.draw = function(view, start, width) {
        for (var r = 0; r < this._rows; r++) {
            for (var c = start; c < width; c++) {
                if (this._tiles[r] && this._tiles[r][c]) {
                    var type = this._tiles[r][c];
                    new TMXTile({
                        superview: view,
                        index: type - 1,
                        x: c * 64,
                        y: r * 64
                    });
                }
            }
        }

    }
});

/*
{
         "data":[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 5, 0, 14, 0, 5, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 6, 0, 28, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 0, 14, 0, 23, 0, 14, 0, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 37, 38, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 0, 0, 28, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 23, 0, 5, 0, 23, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 40, 0, 46, 47, 0, 0, 51, 52, 53, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 28, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 0, 5, 0, 14, 0, 5, 0, 14, 0, 0, 0, 0, 37, 38, 0, 39, 40, 0, 0, 0, 48, 49, 0, 55, 0, 0, 51, 60, 61, 62, 53, 0, 0, 0, 0, 0, 19, 21, 0, 19, 29, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 4, 53, 0, 0, 0, 3, 4, 0, 0, 0, 0, 3, 4, 52, 52, 53, 0, 0, 23, 0, 14, 0, 23, 0, 14, 0, 23, 0, 0, 0, 0, 46, 47, 0, 48, 49, 0, 0, 0, 0, 58, 0, 55, 0, 51, 60, 61, 61, 61, 62, 53, 0, 0, 0, 19, 29, 30, 52, 28, 29, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 12, 13, 62, 51, 52, 53, 12, 13, 53, 0, 0, 51, 12, 13, 61, 61, 62, 0, 0, 0, 0, 23, 0, 0, 0, 23, 0, 0, 0, 0, 0, 0, 55, 0, 0, 0, 58, 0, 0, 0, 0, 58, 0, 55, 0, 60, 61, 61, 61, 61, 61, 62, 0, 51, 19, 29, 29, 30, 61, 28, 29, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 21, 0, 19, 11, 21, 0, 19, 11, 21, 0, 19, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 29, 29, 29, 30, 61, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
         "height":8,
         "name":"Foreground",
         "opacity":1,
         "type":"tilelayer",
         "visible":true,
         "width":73,
         "x":0,
         "y":0
        },
*/
